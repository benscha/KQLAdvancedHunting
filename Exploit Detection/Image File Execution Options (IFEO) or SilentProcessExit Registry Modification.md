# *Image File Execution Options (IFEO) or SilentProcessExit Registry Modification*

## Query Information

#### MITRE ATT&CK Technique(s)

| Technique ID | Title    | Link    |
| ---  | --- | --- |
| T1622| Debugger Evasion | https://attack.mitre.org/techniques/T1622 |
| T1546.012 | Image File Execution Options Injection | https://attack.mitre.org/techniques/T1546/012/ |

#### Description

Detects modifications to the Image File Execution Options (IFEO) or SilentProcessExit registry keys, which can be abused for persistence, privilege escalation, or defense evasion. Adversaries may use these mechanisms to attach debuggers or monitor programs to legitimate executables, causing malicious code to run when the target application starts or exits.

thx to Maurice Fielenbach for Sharing this Attack Path on Linkedin

#### Author <Optional>
- **Name: Benjamin Zulliger**
- **Github: https://github.com/benscha/KQLAdvancedHunting**
- **LinkedIn: https://www.linkedin.com/in/benjamin-zulliger/**

#### References
- https://www.linkedin.com/posts/mauricefielenbach_cybersecurity-dfir-incidentresponse-activity-7424878161253007360-pYk6/


## Defender XDR
```KQL
let ExludedInitiatingProcessFileNames = ("ExludedProcessFilesName.exe");
DeviceRegistryEvents
| where InitiatingProcessFileName !in (ExludedInitiatingProcessFileNames)
| where RegistryKey has_any (
    @"Microsoft\Windows NT\CurrentVersion\Image File Execution Options", 
    @"Microsoft\Windows NT\CurrentVersion\SilentProcessExit"
)
| where RegistryValueName has_any ("Debugger", "MonitorProcess", "ReportingMode", "GlobalFlag")
| extend TargetProcess = tostring(split(RegistryKey, @"\")[8]) 


```
