# *Potential DLL Side-Loading via Certificate*

## Query Information

#### MITRE ATT&CK Technique(s)

| Technique ID | Title    | Link    |
| ---  | --- | --- |
| T1574.001 | Hijack Execution Flow: DLL | https://attack.mitre.org/techniques/T1574/001/ |

#### Description
Based on the Article "Hackers Can Inject Malicious Code into Antivirus to Create a Backdoor" https://cybersecuritynews.com/malicious-code-into-antivirus/
This rule detects suspicious process command lines that indicate potential DLL side-loading. Specifically, it looks for an executable (ending in .exe) followed by three arguments, then a .cer file, and finally a path to a .dll file in the C:\ directory. This pattern can be indicative of an attacker using a legitimate certificate utility to load a malicious DLL.

#### Risk
DLL Side Loading

#### Author <Optional>
- **Name: Benjamin Zulliger**
- **Github: https://github.com/benscha/KQLAdvancedHunting**
- **LinkedIn: https://www.linkedin.com/in/benjamin-zulliger/**

#### References
- https://cybersecuritynews.com/malicious-code-into-antivirus/

## Defender XDR
```KQL
// Based on the Article "Hackers Can Inject Malicious Code into Antivirus to Create a Backdoor" https://cybersecuritynews.com/malicious-code-into-antivirus/
DeviceProcessEvents
| where ProcessCommandLine matches regex @"\w+\.exe\s+\S+\s+\S+\s+\S+\.cer\s+C:\\.*\.dll"
```


